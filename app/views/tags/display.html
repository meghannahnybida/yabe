*{ Display a post in one of these modes: 'full', 'home' or 'teaser' }*

<div class="post ${_as == 'teaser' ? 'teaser' : ''}">
    <h2 class="post-title">
        <a href="@{Application.show(_post.id)}">${_post.title}</a>
    </h2>
    <div class="post-metadata">
        <span class="post-author">
            by#{list items:_post.author, as:'profile'}
                <a href="@{Application.listWrittenBy(profile.fullname)}">${profile.fullname}</a>${profile_isLast ? '' : ', '}
            #{/list}
        </span>,

        <span class="post-date">${_post.postedAt.format('dd MMM yy')}</span>

        #{if _as != 'full'}
            <span class="post-likes">
                &nbsp;|&nbsp; ${_post.likes.size() ?: 'no'}
                like${_post.likes.size().pluralize()}
                #{if _post.likes.size() > 1}
                    , by ${_post.likes[0].author} and more
                #{/if}
            </span>
            <span class="post-comments">
                &nbsp;|&nbsp; ${_post.comments.size() ?: 'no'}
                comment${_post.comments.size().pluralize()}
                #{if _post.comments}
                    , latest by ${_post.comments[0].author}
                #{/if}
            </span>
        #{/if}
        #{elseif _post.tags}
            <span class="post-tags">
                - Tagged
                #{list items:_post.tags, as:'tag'}
                    <a href="@{Application.listTagged(tag.name)}">${tag}</a>${tag_isLast ? '' : ', '}
                #{/list}
            </span>
        #{/elseif}
    </div>
#{if _as != 'teaser'}
    <div class="post-content">
        <div class="about">Detail: </div>
    ${_post.content.nl2br()}
    </div>
#{/if}
</div>

#{if _as == 'full'}

<div class="likes">
    <h3>
    ${_post.likes.size() ?: 'no'}
        like${_post.likes.size().pluralize()}

        <span class="post-likes">
            #{if _post.likes}
                - Liked by
                #{if _post.likes.size() > 5}
                    ${_post.likes[0].author}, ${_post.likes[1].author}, ${_post.likes[2].author}, ${_post.likes[3].author}, ${_post.likes[4].author} and ${_post.likes.size() - 5} more
                #{/if}
            #{else}
                #{list items:_post.likes, as:'like'}
                    <span class="like-author" > ${like.author} ${like_isLast ? '' : ', '}</span>
                #{/list}
            #{/else}
            #{/if}
        </span>
    </h3>

</div>

<div class="comments">
    <h3>
    ${_post.comments.size() ?: 'no'}
        comment${_post.comments.size().pluralize()}
    </h3>

    #{list items:_post.comments, as:'comment'}
        <div class="comment">
            <div class="comment-metadata">
                <span class="comment-author">by <a href="@{Application.listWrittenBy(comment.author)}" style="color: inherit;"target="_blank">${comment.author}</a>${profile_isLast ? '' : ', '},</span>
                <span class="comment-date">
                        ${comment.postedAt.format('dd MMM yy')}
                    </span>
            </div>
            <div class="comment-content">
                <div class="about">Detail: </div>
            ${comment.content.escape().nl2br()}
            </div>
        </div>
    #{/list}
</div>

<h3> Like ${_post.author.fullname}'s post!</h3>

#{/if}
